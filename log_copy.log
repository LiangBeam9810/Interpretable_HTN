nohup: ignoring input
cuda:0
########################################
# correct at frist, no set ramdom seed each fold   
########################################



            orginal   filtered department 
   nums      65141           29545        
              HTN             NHTN        
   nums      18581           10964        
              HTN             NHTN        
   nums      18581           10964        


            orginal    remove diagnose起搏  
   nums      29545           29048        
              HTN             NHTN        
   nums      18113           10935        
           remove HTN     remove NHTN     
   nums       468              29         


            orginal    remove diagnose除颤  
   nums      29048           29048        
              HTN             NHTN        
   nums      18113           10935        
           remove HTN     remove NHTN     
   nums        0               0          


            orginal    remove diagnose电解质 
   nums      29048           27656        
              HTN             NHTN        
   nums      16862           10794        
           remove HTN     remove NHTN     
   nums       1251            141         


            orginal    remove diagnose钙血  
   nums      27656           27499        
              HTN             NHTN        
   nums      16750           10749        
           remove HTN     remove NHTN     
   nums       112              45         


            orginal    remove diagnose钾血  
   nums      27499           26207        
              HTN             NHTN        
   nums      15582           10625        
           remove HTN     remove NHTN     
   nums       1168            124         


            orginal    remove diagnose镁血  
   nums      26207           26200        
              HTN             NHTN        
   nums      15575           10625        
           remove HTN     remove NHTN     
   nums        7               0          


            orginal   remove diagnose心律失常 
   nums      26200           24875        
              HTN             NHTN        
   nums      14338           10537        
           remove HTN     remove NHTN     
   nums       1237             88         


 L2 =  0.007

Batchsize =  256
          Fold 0 of 5 :
                    Validate:  0.18062229988835496 
                     [1916   28] 
                     [2325  305] 
                     precision:  0.9159159159159159 recall:  0.11596958174904944 AUC 0.750047919698321
                    - Epoch: 1 - Train_loss: 0.71031 - Train_acc: 0.66654 -  - Val_loss: 0.81478 - Val_acc: 0.48601  - T_Time: 71.22805 LR：0.0010000000
                    -- -- The best model for validate (F1= .  0.18062229988835496 ) -- --
                    --------------------------------------------------

                    Validation  score to (inf --> -0.81478215).  Saving model ...
                    --------------------------------------------------

                    Validate:  0.5946683521713267 
                     [1663  281] 
                     [1319 1311] 
                     precision:  0.8234924623115578 recall:  0.4984790874524715 AUC 0.7779256442754542
                    - Epoch: 2 - Train_loss: 0.59319 - Train_acc: 0.70533 -  - Val_loss: 0.64189 - Val_acc: 0.65009  - T_Time: 71.58142 LR：0.0010000000
                    -- -- The best model for validate (F1= .  0.5946683521713267 ) -- --
                    --------------------------------------------------

                    Validation  score to (-0.81478215 --> -0.64189500).  Saving model ...
                    --------------------------------------------------

                    Validate:  0.7998185220892645 
                     [990 954] 
                     [ 318 2312] 
                     precision:  0.70789957134109 recall:  0.8790874524714829 AUC 0.7926288746498927
                    - Epoch: 3 - Train_loss: 0.57667 - Train_acc: 0.71673 -  - Val_loss: 0.59159 - Val_acc: 0.72170  - T_Time: 75.65724 LR：0.0010000000
                    -- -- The best model for validate (F1= .  0.7998185220892645 ) -- --
                    --------------------------------------------------

                    Validation  score to (-0.64189500 --> -0.59159209).  Saving model ...
                    --------------------------------------------------

                    Validate:  0.5855963024700712 
                     [1719  225] 
                     [1363 1267] 
                     precision:  0.849195710455764 recall:  0.4817490494296578 AUC 0.7895189840241594
                    - Epoch: 4 - Train_loss: 0.55956 - Train_acc: 0.71898 -  - Val_loss: 0.62082 - Val_acc: 0.65306  - T_Time: 71.67886 LR：0.0010000000
                    EarlyStopping counter: 1 out of 50

                    Validate:  0.6697380498481961 
                     [1621  323] 
                     [1075 1555] 
                     precision:  0.8280085197018104 recall:  0.591254752851711 AUC 0.8070555399083073
                    - Epoch: 5 - Train_loss: 0.55843 - Train_acc: 0.71794 -  - Val_loss: 0.58414 - Val_acc: 0.69449  - T_Time: 72.07269 LR：0.0010000000
                    --------------------------------------------------

                    Validation  score to (-0.59159209 --> -0.58414017).  Saving model ...
                    --------------------------------------------------

                    Validate:  0.7908771544626193 
                     [ 806 1138] 
                     [ 268 2362] 
                     precision:  0.6748571428571428 recall:  0.8980988593155893 AUC 0.7779661315307702
                    - Epoch: 6 - Train_loss: 0.54413 - Train_acc: 0.72860 -  - Val_loss: 0.60652 - Val_acc: 0.69275  - T_Time: 71.86901 LR：0.0010000000
                    EarlyStopping counter: 1 out of 50

                    Validate:  0.4515113455580675 
                     [1838  106] 
                     [1746  884] 
                     precision:  0.8929292929292929 recall:  0.3361216730038023 AUC 0.8053010921779405
                    - Epoch: 7 - Train_loss: 0.53334 - Train_acc: 0.73538 -  - Val_loss: 0.68137 - Val_acc: 0.59513  - T_Time: 72.03955 LR：0.0010000000
                    EarlyStopping counter: 2 out of 50

                    Validate:  0.6311270912826534 
                     [1690  254] 
                     [1220 1410] 
                     precision:  0.8473557692307693 recall:  0.5361216730038023 AUC 0.8099221158209329
                    - Epoch: 8 - Train_loss: 0.52668 - Train_acc: 0.73843 -  - Val_loss: 0.59023 - Val_acc: 0.67783  - T_Time: 75.11571 LR：0.0010000000
                    EarlyStopping counter: 3 out of 50

                    Validate:  0.7356582789278567 
                     [1473  471] 
                     [ 792 1838] 
                     precision:  0.7960155911650065 recall:  0.6988593155893537 AUC 0.8046823412977827
                    - Epoch: 9 - Train_loss: 0.53315 - Train_acc: 0.73333 -  - Val_loss: 0.55122 - Val_acc: 0.72392  - T_Time: 77.96467 LR：0.0010000000
                    --------------------------------------------------

                    Validation  score to (-0.58414017 --> -0.55121581).  Saving model ...
                    --------------------------------------------------

                    Validate:  0.8032936708109552 
                     [1210  734] 
                     [ 411 2219] 
                     precision:  0.7514392143582798 recall:  0.8437262357414449 AUC 0.818363610759048
                    - Epoch: 10 - Train_loss: 0.52460 - Train_acc: 0.74134 -  - Val_loss: 0.52650 - Val_acc: 0.74956  - T_Time: 72.62836 LR：0.0010000000
                    -- -- The best model for validate (F1= .  0.8032936708109552 ) -- --
                    --------------------------------------------------

                    Validation  score to (-0.55121581 --> -0.52649641).  Saving model ...
                    --------------------------------------------------

                    Validate:  0.3185349712161734 
                     [1895   49] 
                     [2054  576] 
                     precision:  0.9216 recall:  0.21901140684410647 AUC 0.8068431285108514
                    - Epoch: 11 - Train_loss: 0.52223 - Train_acc: 0.74138 -  - Val_loss: 0.76900 - Val_acc: 0.54076  - T_Time: 76.62671 LR：0.0010000000
                    EarlyStopping counter: 1 out of 50

                    Validate:  0.6591981556860345 
                     [1679  265] 
                     [1130 1500] 
                     precision:  0.8498583569405099 recall:  0.5703422053231939 AUC 0.8139330923657075
                    - Epoch: 12 - Train_loss: 0.51295 - Train_acc: 0.74789 -  - Val_loss: 0.59119 - Val_acc: 0.69474  - T_Time: 74.99289 LR：0.0010000000
                    EarlyStopping counter: 2 out of 50

                    Validate:  0.6478152675107955 
                     [1717  227] 
                     [1179 1451] 
                     precision:  0.864719904648391 recall:  0.5517110266159696 AUC 0.8259998591747642
                    - Epoch: 13 - Train_loss: 0.51019 - Train_acc: 0.75020 -  - Val_loss: 0.62236 - Val_acc: 0.69265  - T_Time: 70.81230 LR：0.0010000000
                    EarlyStopping counter: 3 out of 50

                    Validate:  0.764681302433223 
                     [1459  485] 
                     [ 680 1950] 
                     precision:  0.8008213552361396 recall:  0.7414448669201521 AUC 0.825534353533931
                    - Epoch: 14 - Train_loss: 0.50792 - Train_acc: 0.74924 -  - Val_loss: 0.52174 - Val_acc: 0.74545  - T_Time: 72.37608 LR：0.0010000000
                    --------------------------------------------------

                    Validation  score to (-0.52649641 --> -0.52173751).  Saving model ...
                    --------------------------------------------------

                    Validate:  0.6603410897528544 
                     [1694  250] 
                     [1132 1498] 
                     precision:  0.8569794050343249 recall:  0.5695817490494297 AUC 0.8255865762255707
                    - Epoch: 15 - Train_loss: 0.50762 - Train_acc: 0.74940 -  - Val_loss: 0.57415 - Val_acc: 0.69816  - T_Time: 70.80685 LR：0.0010000000
                    EarlyStopping counter: 1 out of 50

                    Validate:  0.7048456929098403 
                     [1625  319] 
                     [ 962 1668] 
                     precision:  0.8394564670357323 recall:  0.6342205323193917 AUC 0.822921067455288
                    - Epoch: 16 - Train_loss: 0.49356 - Train_acc: 0.76179 -  - Val_loss: 0.55529 - Val_acc: 0.71984  - T_Time: 76.24756 LR：0.0010000000
                    EarlyStopping counter: 2 out of 50

                    Validate:  0.6374823721517108 
                     [1750  194] 
                     [1222 1408] 
                     precision:  0.8789013732833958 recall:  0.535361216730038 AUC 0.8304497410380385
                    - Epoch: 17 - Train_loss: 0.49171 - Train_acc: 0.75879 -  - Val_loss: 0.61464 - Val_acc: 0.69051  - T_Time: 73.93511 LR：0.0010000000
                    EarlyStopping counter: 3 out of 50

                    Validate:  0.8264616606621089 
                     [1069  875] 
                     [ 242 2388] 
                     precision:  0.7318418633159669 recall:  0.9079847908745247 AUC 0.8431326182540799
                    - Epoch: 18 - Train_loss: 0.48860 - Train_acc: 0.76445 -  - Val_loss: 0.50677 - Val_acc: 0.75567  - T_Time: 75.14458 LR：0.0010000000
                    -- -- The best model for validate (F1= .  0.8264616606621089 ) -- --
                    --------------------------------------------------

                    Validation  score to (-0.52173751 --> -0.50676982).  Saving model ...
                    --------------------------------------------------

                    Validate:  0.7413036090532182 
                     [1634  310] 
                     [ 842 1788] 
                     precision:  0.8522402287893232 recall:  0.6798479087452471 AUC 0.8435349481293714
                    - Epoch: 19 - Train_loss: 0.48467 - Train_acc: 0.76607 -  - Val_loss: 0.52852 - Val_acc: 0.74824  - T_Time: 74.89061 LR：0.0010000000
                    EarlyStopping counter: 1 out of 50

                    Validate:  0.7659138793784566 
                     [1563  381] 
                     [ 723 1907] 
                     precision:  0.8334790209790209 recall:  0.7250950570342205 AUC 0.8414738143297501
                    - Epoch: 20 - Train_loss: 0.48174 - Train_acc: 0.76752 -  - Val_loss: 0.51012 - Val_acc: 0.75866  - T_Time: 70.55975 LR：0.0010000000
                    EarlyStopping counter: 2 out of 50

                    Validate:  0.8224014986705342 
                     [1343  601] 
                     [ 399 2231] 
                     precision:  0.7877824858757062 recall:  0.8482889733840304 AUC 0.85438044719836
                    - Epoch: 21 - Train_loss: 0.47651 - Train_acc: 0.77181 -  - Val_loss: 0.47133 - Val_acc: 0.78106  - T_Time: 76.82259 LR：0.0010000000
                    --------------------------------------------------

                    Validation  score to (-0.50676982 --> -0.47132779).  Saving model ...
                    --------------------------------------------------

                    Validate:  0.6771891735417571 
                     [1738  206] 
                     [1096 1534] 
                     precision:  0.8816091954022989 recall:  0.5832699619771863 AUC 0.8443493874102239
                    - Epoch: 22 - Train_loss: 0.47040 - Train_acc: 0.77647 -  - Val_loss: 0.58727 - Val_acc: 0.71535  - T_Time: 75.18482 LR：0.0010000000
                    EarlyStopping counter: 1 out of 50

                    Validate:  0.7848780644953448 
                     [1520  424] 
                     [ 633 1997] 
                     precision:  0.8248657579512598 recall:  0.7593155893536122 AUC 0.8530081835109296
                    - Epoch: 23 - Train_loss: 0.46438 - Train_acc: 0.77788 -  - Val_loss: 0.47896 - Val_acc: 0.76899  - T_Time: 74.35680 LR：0.0010000000
                    EarlyStopping counter: 2 out of 50

                    Validate:  0.7301967315499115 
                     [1692  252] 
                     [ 905 1725] 
                     precision:  0.8725341426403642 recall:  0.655893536121673 AUC 0.8510577539939602
                    - Epoch: 24 - Train_loss: 0.46464 - Train_acc: 0.77951 -  - Val_loss: 0.51515 - Val_acc: 0.74715  - T_Time: 71.96208 LR：0.0010000000
                    EarlyStopping counter: 3 out of 50

                    Validate:  0.605055510737198 
                     [1816  128] 
                     [1339 1291] 
                     precision:  0.9097956307258633 recall:  0.4908745247148289 AUC 0.8503814016805145
                    - Epoch: 25 - Train_loss: 0.45768 - Train_acc: 0.78305 -  - Val_loss: 0.62154 - Val_acc: 0.67948  - T_Time: 73.61469 LR：0.0010000000
                    EarlyStopping counter: 4 out of 50

                    Validate:  0.8313119017318652 
                     [965 979] 
                     [ 167 2463] 
                     precision:  0.7155723416618245 recall:  0.9365019011406844 AUC 0.8549780742931355
                    - Epoch: 26 - Train_loss: 0.45424 - Train_acc: 0.78266 -  - Val_loss: 0.51375 - Val_acc: 0.74917  - T_Time: 74.64310 LR：0.0010000000
                    -- -- The best model for validate (F1= .  0.8313119017318652 ) -- --
                    EarlyStopping counter: 5 out of 50

                    Validate:  0.7103600085209117 
                     [1738  206] 
                     [ 990 1640] 
                     precision:  0.8884073672806068 recall:  0.623574144486692 AUC 0.8602794598569842
                    - Epoch: 27 - Train_loss: 0.45488 - Train_acc: 0.78465 -  - Val_loss: 0.53137 - Val_acc: 0.73846  - T_Time: 75.08086 LR：0.0010000000
                    EarlyStopping counter: 6 out of 50

                    Validate:  0.8085064292779426 
                     [1540  404] 
                     [ 553 2077] 
                     precision:  0.8371624345022168 recall:  0.7897338403041825 AUC 0.8755532280273514
                    - Epoch: 28 - Train_loss: 0.42131 - Train_acc: 0.80173 -  - Val_loss: 0.44144 - Val_acc: 0.79105  - T_Time: 69.79514 LR：0.0001000000
                    --------------------------------------------------

                    Validation  score to (-0.47132779 --> -0.44144495).  Saving model ...
                    --------------------------------------------------

                    Validate:  0.8123981987161061 
                     [1554  390] 
                     [ 545 2085] 
                     precision:  0.8424242424242424 recall:  0.7927756653992395 AUC 0.8776962164953293
                    - Epoch: 29 - Train_loss: 0.40854 - Train_acc: 0.80801 -  - Val_loss: 0.43849 - Val_acc: 0.79523  - T_Time: 72.85271 LR：0.0001000000
                    --------------------------------------------------

                    Validation  score to (-0.44144495 --> -0.43848976).  Saving model ...
                    --------------------------------------------------

                    Validate:  0.7782287452776572 
                     [1657  287] 
                     [ 722 1908] 
                     precision:  0.869248291571754 recall:  0.7254752851711027 AUC 0.8780607973837801
                    - Epoch: 30 - Train_loss: 0.40523 - Train_acc: 0.81165 -  - Val_loss: 0.45512 - Val_acc: 0.77930  - T_Time: 72.45400 LR：0.0001000000
                    EarlyStopping counter: 1 out of 50

                    Validate:  0.8045444157879272 
                     [1625  319] 
                     [ 610 2020] 
                     precision:  0.8636169303120992 recall:  0.7680608365019012 AUC 0.880178065687149
                    - Epoch: 31 - Train_loss: 0.39864 - Train_acc: 0.81599 -  - Val_loss: 0.44373 - Val_acc: 0.79637  - T_Time: 75.42081 LR：0.0001000000
                    EarlyStopping counter: 2 out of 50

                    Validate:  0.8117355318669287 
                     [1587  357] 
                     [ 564 2066] 
                     precision:  0.8526619892695007 recall:  0.785551330798479 AUC 0.8789765525982256
                    - Epoch: 32 - Train_loss: 0.39791 - Train_acc: 0.81315 -  - Val_loss: 0.43807 - Val_acc: 0.79900  - T_Time: 72.88106 LR：0.0001000000
                    --------------------------------------------------

                    Validation  score to (-0.43848976 --> -0.43806651).  Saving model ...
                    --------------------------------------------------

                    Validate:  0.8023072410871406 
                     [1612  332] 
                     [ 612 2018] 
                     precision:  0.8587234042553191 recall:  0.7673003802281368 AUC 0.8789184621884242
                    - Epoch: 33 - Train_loss: 0.39519 - Train_acc: 0.81767 -  - Val_loss: 0.44262 - Val_acc: 0.79371  - T_Time: 75.56266 LR：0.0001000000
                    EarlyStopping counter: 1 out of 50

                    Validate:  0.7748386878821663 
                     [1691  253] 
                     [ 750 1880] 
                     precision:  0.8813877168307548 recall:  0.714828897338403 AUC 0.8789370432959365
                    - Epoch: 34 - Train_loss: 0.39307 - Train_acc: 0.81916 -  - Val_loss: 0.46019 - Val_acc: 0.78091  - T_Time: 72.52518 LR：0.0001000000
                    EarlyStopping counter: 2 out of 50

                    Validate:  0.8140845967639192 
                     [1547  397] 
                     [ 535 2095] 
                     precision:  0.8406902086677368 recall:  0.7965779467680608 AUC 0.8789860387425872
                    - Epoch: 35 - Train_loss: 0.38744 - Train_acc: 0.82327 -  - Val_loss: 0.44111 - Val_acc: 0.79605  - T_Time: 77.42091 LR：0.0001000000
                    EarlyStopping counter: 3 out of 50

                    Validate:  0.7881942830583315 
                     [1653  291] 
                     [ 684 1946] 
                     precision:  0.869915064818954 recall:  0.7399239543726236 AUC 0.8761488992160728
                    - Epoch: 36 - Train_loss: 0.38870 - Train_acc: 0.81896 -  - Val_loss: 0.46227 - Val_acc: 0.78682  - T_Time: 73.26810 LR：0.0001000000
                    EarlyStopping counter: 4 out of 50

                    Validate:  0.7889704423725452 
                     [1638  306] 
                     [ 674 1956] 
                     precision:  0.8647214854111406 recall:  0.7437262357414449 AUC 0.8787707912813532
                    - Epoch: 37 - Train_loss: 0.38276 - Train_acc: 0.82555 -  - Val_loss: 0.45164 - Val_acc: 0.78586  - T_Time: 71.31772 LR：0.0001000000
                    EarlyStopping counter: 5 out of 50

                    Validate:  0.7896715486035003 
                     [1658  286] 
                     [ 681 1949] 
                     precision:  0.8720357941834452 recall:  0.74106463878327 AUC 0.8801745450562518
                    - Epoch: 38 - Train_loss: 0.37590 - Train_acc: 0.83047 -  - Val_loss: 0.45207 - Val_acc: 0.78842  - T_Time: 73.63684 LR：0.0001000000
                    EarlyStopping counter: 6 out of 50

                    Validate:  0.79912488485327 
                     [1643  301] 
                     [ 639 1991] 
                     precision:  0.868673647469459 recall:  0.7570342205323194 AUC 0.8823855012596036
                    - Epoch: 39 - Train_loss: 0.36961 - Train_acc: 0.83084 -  - Val_loss: 0.44741 - Val_acc: 0.79471  - T_Time: 75.77801 LR：0.0000100000
                    EarlyStopping counter: 7 out of 50

                    Validate:  0.7964212746325711 
                     [1643  301] 
                     [ 649 1981] 
                     precision:  0.8680981595092024 recall:  0.7532319391634981 AUC 0.8819117808133441
                    - Epoch: 40 - Train_loss: 0.36521 - Train_acc: 0.83468 -  - Val_loss: 0.44819 - Val_acc: 0.79257  - T_Time: 71.55020 LR：0.0000100000
                    EarlyStopping counter: 8 out of 50

                    Validate:  0.7992771717702721 
                     [1638  306] 
                     [ 636 1994] 
                     precision:  0.8669565217391304 recall:  0.7581749049429658 AUC 0.880821460983586
                    - Epoch: 41 - Train_loss: 0.37223 - Train_acc: 0.83081 -  - Val_loss: 0.45047 - Val_acc: 0.79374  - T_Time: 72.10873 LR：0.0000100000
                    EarlyStopping counter: 9 out of 50

                    Validate:  0.8027788701009309 
                     [1636  308] 
                     [ 622 2008] 
                     precision:  0.8670120898100173 recall:  0.7634980988593156 AUC 0.8823141106886352
                    - Epoch: 42 - Train_loss: 0.36748 - Train_acc: 0.83309 -  - Val_loss: 0.44751 - Val_acc: 0.79675  - T_Time: 72.41419 LR：0.0000100000
                    EarlyStopping counter: 10 out of 50

                    Validate:  0.8040467128590483 
                     [1609  335] 
                     [ 604 2026] 
                     precision:  0.8581109699279966 recall:  0.7703422053231939 AUC 0.8814400162731384
                    - Epoch: 43 - Train_loss: 0.36679 - Train_acc: 0.83575 -  - Val_loss: 0.44617 - Val_acc: 0.79496  - T_Time: 71.85564 LR：0.0000100000
                    EarlyStopping counter: 11 out of 50

                    Validate:  0.8006487336587924 
                     [1630  314] 
                     [ 627 2003] 
                     precision:  0.8644799309451877 recall:  0.7615969581749049 AUC 0.880997785914347
                    - Epoch: 44 - Train_loss: 0.36529 - Train_acc: 0.83520 -  - Val_loss: 0.45017 - Val_acc: 0.79416  - T_Time: 74.65817 LR：0.0000100000
                    EarlyStopping counter: 12 out of 50

                    Validate:  0.8026892072713032 
                     [1619  325] 
                     [ 614 2016] 
                     precision:  0.8611704399829133 recall:  0.7665399239543726 AUC 0.881345546010734
                    - Epoch: 45 - Train_loss: 0.36238 - Train_acc: 0.83755 -  - Val_loss: 0.44646 - Val_acc: 0.79493  - T_Time: 77.44764 LR：0.0000010000
                    EarlyStopping counter: 13 out of 50

                    Validate:  0.7968314614143144 
                     [1642  302] 
                     [ 647 1983] 
                     precision:  0.8678336980306346 recall:  0.7539923954372624 AUC 0.8811593437544007
                    - Epoch: 46 - Train_loss: 0.36539 - Train_acc: 0.83664 -  - Val_loss: 0.45310 - Val_acc: 0.79286  - T_Time: 74.94119 LR：0.0000010000
                    EarlyStopping counter: 14 out of 50

                    Validate:  0.798089673734655 
                     [1631  313] 
                     [ 637 1993] 
                     precision:  0.8642671292281006 recall:  0.7577946768060837 AUC 0.8812653538625232
                    - Epoch: 47 - Train_loss: 0.36573 - Train_acc: 0.83404 -  - Val_loss: 0.45138 - Val_acc: 0.79217  - T_Time: 72.70814 LR：0.0000010000
                    EarlyStopping counter: 15 out of 50

                    Validate:  0.7956084533975141 
                     [1643  301] 
                     [ 652 1978] 
                     precision:  0.8679245283018868 recall:  0.7520912547528517 AUC 0.8809009685646779
                    - Epoch: 48 - Train_loss: 0.36004 - Train_acc: 0.83925 -  - Val_loss: 0.45452 - Val_acc: 0.79186  - T_Time: 72.37911 LR：0.0000010000
                    EarlyStopping counter: 16 out of 50

                    Validate:  0.7871492368193028 
                     [1666  278] 
                     [ 694 1936] 
                     precision:  0.8744354110207768 recall:  0.7361216730038023 AUC 0.8806764305496879
                    - Epoch: 49 - Train_loss: 0.37074 - Train_acc: 0.83225 -  - Val_loss: 0.46013 - Val_acc: 0.78750  - T_Time: 73.60760 LR：0.0000010000
                    EarlyStopping counter: 17 out of 50

                    Validate:  0.8040194447163226 
                     [1621  323] 
                     [ 610 2020] 
                     precision:  0.8621425522833973 recall:  0.7680608365019012 AUC 0.8815274452737487
                    - Epoch: 50 - Train_loss: 0.36163 - Train_acc: 0.83941 -  - Val_loss: 0.44819 - Val_acc: 0.79570  - T_Time: 76.30791 LR：0.0000010000
                    EarlyStopping counter: 18 out of 50

                    Validate:  0.8033446563888161 
                     [1624  320] 
                     [ 614 2016] 
                     precision:  0.863013698630137 recall:  0.7665399239543726 AUC 0.8812853041042732
                    - Epoch: 51 - Train_loss: 0.35986 - Train_acc: 0.83999 -  - Val_loss: 0.44876 - Val_acc: 0.79558  - T_Time: 73.51711 LR：0.0000001000
                    EarlyStopping counter: 19 out of 50

                    Validate:  0.8026735520983136 
                     [1625  319] 
                     [ 617 2013] 
                     precision:  0.8632075471698113 recall:  0.7653992395437262 AUC 0.8807237634761927
                    - Epoch: 52 - Train_loss: 0.36707 - Train_acc: 0.83381 -  - Val_loss: 0.45136 - Val_acc: 0.79541  - T_Time: 77.81900 LR：0.0000001000
                    EarlyStopping counter: 20 out of 50

                    Validate:  0.7973961073119411 
                     [1636  308] 
                     [ 642 1988] 
                     precision:  0.8658536585365854 recall:  0.755893536121673 AUC 0.8814653452565366
                    - Epoch: 53 - Train_loss: 0.36588 - Train_acc: 0.83664 -  - Val_loss: 0.45132 - Val_acc: 0.79234  - T_Time: 73.27470 LR：0.0000001000
                    EarlyStopping counter: 21 out of 50

                    Validate:  0.8005427319688747 
                     [1621  323] 
                     [ 623 2007] 
                     precision:  0.8613733905579399 recall:  0.7631178707224334 AUC 0.8809919181961852
                    - Epoch: 54 - Train_loss: 0.36660 - Train_acc: 0.83704 -  - Val_loss: 0.45126 - Val_acc: 0.79294  - T_Time: 71.60631 LR：0.0000001000
                    EarlyStopping counter: 22 out of 50

                    Validate:  0.799993452497872 
                     [1625  319] 
                     [ 627 2003] 
                     precision:  0.8626184323858742 recall:  0.7615969581749049 AUC 0.8815988358447168
                    - Epoch: 55 - Train_loss: 0.36182 - Train_acc: 0.83646 -  - Val_loss: 0.44899 - Val_acc: 0.79324  - T_Time: 75.41188 LR：0.0000001000
                    EarlyStopping counter: 23 out of 50

                    Validate:  0.8 
                     [1623  321] 
                     [ 626 2004] 
                     precision:  0.8619354838709677 recall:  0.7619771863117871 AUC 0.8809179849473471
                    - Epoch: 56 - Train_loss: 0.37114 - Train_acc: 0.83356 -  - Val_loss: 0.44995 - Val_acc: 0.79316  - T_Time: 72.87169 LR：0.0000001000
                    EarlyStopping counter: 24 out of 50

                    Validate:  0.7929838496160975 
                     [1652  292] 
                     [ 666 1964] 
                     precision:  0.8705673758865248 recall:  0.7467680608365019 AUC 0.8809565162966091
                    - Epoch: 57 - Train_loss: 0.36100 - Train_acc: 0.83840 -  - Val_loss: 0.45539 - Val_acc: 0.79044  - T_Time: 68.11796 LR：0.0000000100
                    EarlyStopping counter: 25 out of 50

                    Validate:  0.7974118110753465 
                     [1632  312] 
                     [ 640 1990] 
                     precision:  0.8644656820156386 recall:  0.7566539923954373 AUC 0.8811611040698493
                    - Epoch: 58 - Train_loss: 0.36257 - Train_acc: 0.83749 -  - Val_loss: 0.45025 - Val_acc: 0.79204  - T_Time: 74.01156 LR：0.0000000100
                    EarlyStopping counter: 26 out of 50

                    Validate:  0.8049550136914851 
                     [1620  324] 
                     [ 606 2024] 
                     precision:  0.8620102214650767 recall:  0.7695817490494297 AUC 0.8814635849410881
                    - Epoch: 59 - Train_loss: 0.36009 - Train_acc: 0.83873 -  - Val_loss: 0.44846 - Val_acc: 0.79681  - T_Time: 74.84476 LR：0.0000000100
                    EarlyStopping counter: 27 out of 50

                    Validate:  0.8010605217505155 
                     [1627  317] 
                     [ 624 2006] 
                     precision:  0.8635385277658201 recall:  0.7627376425855513 AUC 0.8814367890281494
                    - Epoch: 60 - Train_loss: 0.36573 - Train_acc: 0.83518 -  - Val_loss: 0.45036 - Val_acc: 0.79429  - T_Time: 74.24701 LR：0.0000000100
                    EarlyStopping counter: 28 out of 50

                    Validate:  0.796315304645348 
                     [1636  308] 
                     [ 646 1984] 
                     precision:  0.8656195462478184 recall:  0.7543726235741445 AUC 0.8812843261512462
                    - Epoch: 61 - Train_loss: 0.36564 - Train_acc: 0.83411 -  - Val_loss: 0.45181 - Val_acc: 0.79147  - T_Time: 73.00759 LR：0.0000000100
                    EarlyStopping counter: 29 out of 50

                    Validate:  0.8013404825737265 
                     [1623  321] 
                     [ 621 2009] 
                     precision:  0.8622317596566523 recall:  0.7638783269961977 AUC 0.8815415277973369
                    - Epoch: 62 - Train_loss: 0.36447 - Train_acc: 0.83621 -  - Val_loss: 0.44994 - Val_acc: 0.79394  - T_Time: 73.98381 LR：0.0000000100
                    EarlyStopping counter: 30 out of 50

                    Validate:  0.8003992015968063 
                     [1624  320] 
                     [ 625 2005] 
                     precision:  0.8623655913978494 recall:  0.7623574144486692 AUC 0.8810779780625577
                    - Epoch: 63 - Train_loss: 0.36323 - Train_acc: 0.83649 -  - Val_loss: 0.45050 - Val_acc: 0.79353  - T_Time: 71.13089 LR：0.0000000100
                    EarlyStopping counter: 31 out of 50

                    Validate:  0.7963320844014988 
                     [1632  312] 
                     [ 644 1986] 
                     precision:  0.8642297650130548 recall:  0.7551330798479088 AUC 0.8813629535746139
                    - Epoch: 64 - Train_loss: 0.36923 - Train_acc: 0.83348 -  - Val_loss: 0.45143 - Val_acc: 0.79117  - T_Time: 74.70785 LR：0.0000000100
                    EarlyStopping counter: 32 out of 50

                    Validate:  0.7938204289349329 
                     [1648  296] 
                     [ 661 1969] 
                     precision:  0.8693156732891832 recall:  0.7486692015209125 AUC 0.8809438029072587
                    - Epoch: 65 - Train_loss: 0.36300 - Train_acc: 0.83708 -  - Val_loss: 0.45499 - Val_acc: 0.79079  - T_Time: 72.67785 LR：0.0000000100
                    EarlyStopping counter: 33 out of 50

                    Validate:  0.7972808774752882 
                     [1631  313] 
                     [ 640 1990] 
                     precision:  0.864090316977855 recall:  0.7566539923954373 AUC 0.8810210611963887
                    - Epoch: 66 - Train_loss: 0.36215 - Train_acc: 0.83638 -  - Val_loss: 0.45339 - Val_acc: 0.79162  - T_Time: 70.07140 LR：0.0000000100
                    EarlyStopping counter: 34 out of 50

                    Validate:  0.8001179322544716 
                     [1628  316] 
                     [ 628 2002] 
                     precision:  0.8636755823986195 recall:  0.7612167300380228 AUC 0.8813592373531114
                    - Epoch: 67 - Train_loss: 0.36515 - Train_acc: 0.83410 -  - Val_loss: 0.44967 - Val_acc: 0.79354  - T_Time: 73.95683 LR：0.0000000100
                    EarlyStopping counter: 35 out of 50

                    Validate:  0.8004986713034348 
                     [1635  309] 
                     [ 630 2000] 
                     precision:  0.8661758336942399 recall:  0.7604562737642585 AUC 0.8811918117948959
                    - Epoch: 68 - Train_loss: 0.36821 - Train_acc: 0.83332 -  - Val_loss: 0.45128 - Val_acc: 0.79496  - T_Time: 73.32031 LR：0.0000000100
                    EarlyStopping counter: 36 out of 50

                    Validate:  0.797257120305203 
                     [1637  307] 
                     [ 643 1987] 
                     precision:  0.8661726242371404 recall:  0.7555133079847909 AUC 0.8812479462986436
                    - Epoch: 69 - Train_loss: 0.36625 - Train_acc: 0.83574 -  - Val_loss: 0.45287 - Val_acc: 0.79234  - T_Time: 68.07769 LR：0.0000000100
                    EarlyStopping counter: 37 out of 50

                    Validate:  0.8007860862729687 
                     [1629  315] 
                     [ 626 2004] 
                     precision:  0.8641655886157826 recall:  0.7619771863117871 AUC 0.8813948348432928
                    - Epoch: 70 - Train_loss: 0.36687 - Train_acc: 0.83445 -  - Val_loss: 0.45130 - Val_acc: 0.79433  - T_Time: 72.23372 LR：0.0000000100
                    EarlyStopping counter: 38 out of 50

                    Validate:  0.7992979232964798 
                     [1632  312] 
                     [ 633 1997] 
                     precision:  0.8648765699436985 recall:  0.7593155893536122 AUC 0.8809426293636266
                    - Epoch: 71 - Train_loss: 0.36487 - Train_acc: 0.83625 -  - Val_loss: 0.45170 - Val_acc: 0.79359  - T_Time: 73.57979 LR：0.0000000100
                    EarlyStopping counter: 39 out of 50

                    Validate:  0.7978902953586496 
                     [1648  296] 
                     [ 646 1984] 
                     precision:  0.8701754385964913 recall:  0.7543726235741445 AUC 0.8811779248619129
                    - Epoch: 72 - Train_loss: 0.36330 - Train_acc: 0.83696 -  - Val_loss: 0.45340 - Val_acc: 0.79401  - T_Time: 76.94184 LR：0.0000000100
                    EarlyStopping counter: 40 out of 50

                    Validate:  0.7995670143672504 
                     [1632  312] 
                     [ 632 1998] 
                     precision:  0.8649350649350649 recall:  0.7596958174904943 AUC 0.8813789920042558
                    - Epoch: 73 - Train_loss: 0.36255 - Train_acc: 0.83909 -  - Val_loss: 0.45019 - Val_acc: 0.79344  - T_Time: 67.98008 LR：0.0000000100
                    EarlyStopping counter: 41 out of 50

                    Validate:  0.7935287500827101 
                     [1652  292] 
                     [ 664 1966] 
                     precision:  0.870682019486271 recall:  0.7475285171102661 AUC 0.8812199768420724
                    - Epoch: 74 - Train_loss: 0.36026 - Train_acc: 0.83812 -  - Val_loss: 0.45353 - Val_acc: 0.79074  - T_Time: 72.33599 LR：0.0000000100
                    EarlyStopping counter: 42 out of 50

                    Validate:  0.7965938979484481 
                     [1634  310] 
                     [ 644 1986] 
                     precision:  0.8649825783972126 recall:  0.7551330798479088 AUC 0.8813635403464302
                    - Epoch: 75 - Train_loss: 0.36352 - Train_acc: 0.83732 -  - Val_loss: 0.45013 - Val_acc: 0.79177  - T_Time: 71.65076 LR：0.0000000100
                    EarlyStopping counter: 43 out of 50

                    Validate:  0.7987522983976885 
                     [1634  310] 
                     [ 636 1994] 
                     precision:  0.8654513888888888 recall:  0.7581749049429658 AUC 0.8813224663192977
                    - Epoch: 76 - Train_loss: 0.36094 - Train_acc: 0.83873 -  - Val_loss: 0.45135 - Val_acc: 0.79331  - T_Time: 76.41157 LR：0.0000000100
                    EarlyStopping counter: 44 out of 50

                    Validate:  0.794542038825352 
                     [1639  305] 
                     [ 654 1976] 
                     precision:  0.866286716352477 recall:  0.7513307984790875 AUC 0.8810615484517048
                    - Epoch: 77 - Train_loss: 0.36637 - Train_acc: 0.83573 -  - Val_loss: 0.45408 - Val_acc: 0.79039  - T_Time: 74.82323 LR：0.0000000100
                    EarlyStopping counter: 45 out of 50

                    Validate:  0.7918046330260071 
                     [1643  301] 
                     [ 666 1964] 
                     precision:  0.8671081677704194 recall:  0.7467680608365019 AUC 0.8810659492403261
                    - Epoch: 78 - Train_loss: 0.36518 - Train_acc: 0.83425 -  - Val_loss: 0.45335 - Val_acc: 0.78859  - T_Time: 70.38324 LR：0.0000000100
                    EarlyStopping counter: 46 out of 50

                    Validate:  0.7985848746133087 
                     [1643  301] 
                     [ 641 1989] 
                     precision:  0.8685589519650655 recall:  0.7562737642585551 AUC 0.881187313210972
                    - Epoch: 79 - Train_loss: 0.36518 - Train_acc: 0.83687 -  - Val_loss: 0.45188 - Val_acc: 0.79438  - T_Time: 72.40586 LR：0.0000000100
                    EarlyStopping counter: 47 out of 50

                    Validate:  0.8011916453872847 
                     [1628  316] 
                     [ 624 2006] 
                     precision:  0.8639104220499569 recall:  0.7627376425855513 AUC 0.8815450484282339
                    - Epoch: 80 - Train_loss: 0.36551 - Train_acc: 0.83653 -  - Val_loss: 0.44826 - Val_acc: 0.79444  - T_Time: 71.59868 LR：0.0000000100
                    EarlyStopping counter: 48 out of 50

                    Validate:  0.7929636255217649 
                     [1656  288] 
                     [ 668 1962] 
                     precision:  0.872 recall:  0.7460076045627376 AUC 0.8811875088015773
                    - Epoch: 81 - Train_loss: 0.35893 - Train_acc: 0.84056 -  - Val_loss: 0.45509 - Val_acc: 0.79137  - T_Time: 76.04665 LR：0.0000000100
                    EarlyStopping counter: 49 out of 50

                    Validate:  0.7965690955187515 
                     [1640  304] 
                     [ 647 1983] 
                     precision:  0.8670747704416266 recall:  0.7539923954372624 AUC 0.8815290099985917
                    - Epoch: 82 - Train_loss: 0.36027 - Train_acc: 0.83747 -  - Val_loss: 0.45238 - Val_acc: 0.79206  - T_Time: 72.99041 LR：0.0000000100
                    EarlyStopping counter: 50 out of 50

                    Early stopping...
     Best Loss:
Traceback (most recent call last):
  File "./main_2023_copy.py", line 229, in <module>
    data_path= data_root
  File "/workspace/data/Interpretable_HTN/train_test_validat.py", line 164, in tarinning_one_flod
    save_test_infos(log_path+'/Validate_answer_'+str(fold)+'.csv',val_dataset, y_true,y_pred,y_out)
  File "/workspace/data/Interpretable_HTN/train_test_validat.py", line 231, in save_test_infos
    test_infors_Df = (test_dataset.infos.copy()).reset_index()
  File "/opt/conda/lib/python3.7/site-packages/pandas/util/_decorators.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py", line 5799, in reset_index
    new_obj.insert(0, name, level_values)
  File "/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py", line 4414, in insert
    raise ValueError(f"cannot insert {column}, already exists")
ValueError: cannot insert level_0, already exists

test
 [726 180] 
 [278 824] 
 F1_score:  0.7825261158594492 
 precision:  0.8207171314741036 
 recall:  0.7477313974591652 AUC 0.8585223334655434